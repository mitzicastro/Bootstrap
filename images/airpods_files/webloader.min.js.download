!function(){"use strict";var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var n=Object.prototype.toString.call(e);return"[object RegExp]"===n||"[object Date]"===n||function(e){return e.$$typeof===t}(e)}(e)};var t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,i){return e.concat(t).map((function(e){return n(e,i)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function r(e,t){try{return t in e}catch(e){return!1}}function s(e,t,i){var s={};return i.isMergeableObject(e)&&o(e).forEach((function(t){s[t]=n(e[t],i)})),o(t).forEach((function(o){(function(e,t){return r(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,o)||(r(e,o)&&i.isMergeableObject(t[o])?s[o]=function(e,t){if(!t.customMerge)return c;var n=t.customMerge(e);return"function"==typeof n?n:c}(o,i)(e[o],t[o],i):s[o]=n(t[o],i))})),s}function c(t,o,r){(r=r||{}).arrayMerge=r.arrayMerge||i,r.isMergeableObject=r.isMergeableObject||e,r.cloneUnlessOtherwiseSpecified=n;var c=Array.isArray(o);return c===Array.isArray(t)?c?r.arrayMerge(t,o,r):s(t,o,r):n(o,r)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return c(e,n,t)}),{})};const a=c;function u(e){return JSON.parse(JSON.stringify(e))}function d(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function f(e,t){return function e(n,i){let o=[];return Object.keys(n).filter(t||function(){return!0}).forEach((function(t){let r=n[t],s=i?i+"."+t:t;o.push(s),d(r)&&(o=o.concat(e(n[t],s)))})),o}(e,"")}function l(e,t){return function e(t,n,i){let o=t[n];if(n===t.length-1)return delete i[o],!0;if(!(o in i))return!1;const r=e(t,n+1,i[o]);return r&&0===Object.keys(i[o]).length&&delete i[o],r}(e.split("."),0,t)}function h(e,t){let n,i=t,o=e.split(".");for(let e=0;e<o.length;e++){let t=o[e];if(e===o.length-1){n=i[t];break}if(!(t in i))break;i=i[t]}return n}function v(e,t,n){let i=n,o=e.split(".");for(let e=0;e<o.length;e++){let n=o[e];if(e===o.length-1){i[n]=t;break}n in i||(i[n]={}),i=i[n]}return t}function p(e,t){const n={};return t.forEach((function(t){const i=t.split(".");let o=e;for(let e=0;e<i.length;e++){let r=o[i[e]];if(!r)break;if(e===i.length-1){n[t]=r;break}o=r}})),function(e,t){function n(e,t,i){if("object"!=typeof e||null===e)return e;if(e._predicated_values){const n=i.join(".");for(let i=0;i<e._predicated_values.length;i++)if(t.has(n+"."+e._predicated_values[i]._predicate_assignment_id))return e._predicated_values[i]._value;return null}const o=Object.keys(e);for(let r=0;r<o.length;r++){const s=o[r],c=i.concat([s]);e[s]=n(e[s],t,c)}return e}n(e,t,[])}(n,t),n}function m(e,t){return function(e){let t={};return Object.keys(e).forEach((function(n){v(n,e[n],t)})),t}(p(e,t))}function g(e,t){if(Object.assign)return Object.assign.apply(void 0,arguments);if(null==e)throw new TypeError("Cannot convert undefined or null to object");const n=Object(e);for(let e=1;e<arguments.length;e++){let t=arguments[e];if(null!=t)for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e])}return n}const y=new Map,w=new Map,b=new Map;function E(e){y.has(e)||(y.set(e,{}),w.set(e,{}),b.set(e,{}))}function x(e,t,n){E(e);const i=y.get(e),o=b.get(e);i[t]?i[t].push(n):i[t]=[n],o[t]&&n.apply(void 0,o[t])}function _(e,t,n){E(e);const i=w.get(e),o=b.get(e);o[t]?n.apply(void 0,o[t]):i[t]?i.push(n):i[t]=[n]}function k(e,t){E(e);const n=y.get(e),i=w.get(e),o=b.get(e),r=[].slice.call(arguments);r.shift(),o[t]=r;const s=i[t];for(;s&&s.length;){let e=s.shift();try{e.apply(void 0,r)}catch(e){console.error(e),console.log("Failed to invoke one time handler of %s",t)}}const c=n[t];c&&c.forEach((function(e){try{e.apply(void 0,r)}catch(e){console.error(e),console.log("Failed to invoke handler of %s",t)}}))}const O="context.changed",A="context.initialized",j="context.value.removed",C="context.value.added",S="context.value.changed";function T(e){let t,n,i,o,r=!1;function s(){if(!r)throw new Error("Evolv: The evolv context is not initialized")}Object.defineProperty(this,"uid",{get:function(){return t}}),Object.defineProperty(this,"sid",{get:function(){return n}}),Object.defineProperty(this,"remoteContext",{get:function(){return u(i)}}),Object.defineProperty(this,"localContext",{get:function(){return u(o)}}),this.initialize=function(e,s,c,a){if(r)throw new Error("Evolv: The context is already initialized");t=e,n=s,i=c?u(c):{},o=a?u(a):{},r=!0,k(this,A,this.resolve())},this.destroy=function(){i=void 0,o=void 0,k(this,"context.destroyed",this)},this.resolve=function(){return s(),u(a(o,i))},this.set=function(e,t,n){s();const r=n?o:i,c=h(e,r);if(c===t||function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(c,t))return!1;v(e,t,r);const a=this.resolve();return void 0===c?k(this,C,e,t,n,a):k(this,S,e,t,c,n,a),k(this,O,a),!0},this.update=function(t,n){0===Object.keys(t).length&&t.constructor===Object&&(console.warn("[Deprecation] Calling evolv.context.update({}) to reapply variants has been deprecated. Please use 'evolv.rerun()' instead."),e.clearActiveKeys()),s();let r=n?o:i;const c=function(e,t){return function e(n,i){let o={};return Object.keys(n).filter(t||function(){return!0}).forEach((function(t){let r=n[t],s=i?i+"."+t:t;d(r)?o=g(o,e(n[t],s)):o[s]=r})),o}(e,"")}(t),u={};Object.keys(c).forEach((function(e){u[e]=r[e]})),n?(o=a(o,t),r=o):(i=a(i,t),r=i);const f=this,l=this.resolve();Object.keys(c).forEach((function(e){void 0===u[e]?k(f,C,e,c[e],n,l):u[e]!==r[e]&&k(f,S,e,c[e],u[e],n,l)})),k(this,O,l)},this.remove=function(e){s();const t=l(e,o),n=l(e,i),r=t||n;if(r){const t=this.resolve();k(this,j,e,!n,t),k(this,O,t)}return r},this.get=function(e){return s(),"confirmations"!==e&&"contaminations"!==e||console.warn('[Deprecation] Retrieving confirmations and contaminations from the Evolv context with keys "confirmations"',' and "contaminations" is deprecated. Please use "experiments.confirmations" and "experiments.contaminations" instead.'),h(e,i)||h(e,o)},this.contains=function(e){return s(),e in i||e in o},this.pushToArray=function(e,t,n,r){r=r||50,s();const c=(h(e,n?o:i)||[]).concat([t]),a=c.slice(c.length-r);return this.set(e,a,n)}}const P=function(e,t){t.apply(this,e)};function I(e){this._responseArgs=null,this._errored=!1,this._thens=[],this._catches=[],this._finallys=[];const t=function(e,t){if(this._responseArgs)throw Error("Response already sent");const n=Array.prototype.slice.call(arguments);n.shift(),n.shift(),this._errored=e,this._responseArgs=n,t.forEach(P.bind(this,n)),this._finallys.forEach(P.bind(this,n))},n=t.bind(this,!0,this._catches),i=t.bind(this,!1,this._thens);try{e(i,n)}catch(e){n(e)}this.then=function(e){return this._responseArgs&&!this._errored?(P.call(this,this._responseArgs,e),this):(this._thens.push(e),this)},this.catch=function(e){return this._responseArgs&&this._errored?(P.call(this,this._responseArgs,e),this):(this._catches.push(e),this)},this.finally=function(e){return this._responseArgs?(P.call(this,this._responseArgs,e),this):(this._finallys.push(e),this)}}function L(e){if(Array.isArray(e))return e;if(e instanceof Map){const t=[];return e.forEach((function(e,n){t.push([n,e])})),t}if(e instanceof Set||e instanceof NodeList){const t=[];return(e.forEach||R).call(e,(function(e){t.push(e)})),t}return[]}function R(e,t){t=t||window;for(let n=0;n<this.length;n+=1)e.call(t,this[n],this)}function M(e,t,n){if(e.startsWith)return e.startsWith(t,n);const i=n>0?0|n:0;return e.substring(i,i+t.length)===t}function q(e,t,n){if(e.endsWith)return e.endsWith(t,n);const i=void 0===n||n>e.length?e.length:n;return e.substring(i-t.length,i)===t}function z(e,t){const n=t||new Set;return e.forEach((function(e){n.add(e)})),n}I.createPromise=function(e){return new("undefined"!=typeof Promise?Promise:I)(e)};var U,F=(function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<e.length;i++)n[e.charCodeAt(i)]=i;t.encode=function(t){var n,i=new Uint8Array(t),o=i.length,r="";for(n=0;n<o;n+=3)r+=e[i[n]>>2],r+=e[(3&i[n])<<4|i[n+1]>>4],r+=e[(15&i[n+1])<<2|i[n+2]>>6],r+=e[63&i[n+2]];return o%3==2?r=r.substring(0,r.length-1)+"=":o%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(e){var t,i,o,r,s,c=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(c--,"="===e[e.length-2]&&c--);var d=new ArrayBuffer(c),f=new Uint8Array(d);for(t=0;t<a;t+=4)i=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],r=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],f[u++]=i<<2|o>>4,f[u++]=(15&o)<<4|r>>2,f[u++]=(3&r)<<6|63&s;return d}}()}(U={exports:{}},U.exports),U.exports),N=(F.encode,F.decode,{encode:function(e){return"undefined"!=typeof btoa?btoa(e):Buffer.from(e).toString("base64")},decode:function(e){return"undefined"!=typeof atob?atob(e):Buffer.from(e,"base64").toString()},encodeFromArrayBuffer:F.encode,decodeToArrayBuffer:F.decode});const D={contains:function(e,t){return e.indexOf(t)>=0},defined:function(e){return void 0!==e},equal:function(e,t){return e===t},exists:function(e){return null!==e},not_contains:function(e,t){return!(e.indexOf(t)>=0)},not_defined:function(e){return void 0===e},not_equal:function(e,t){return e!==t},not_regex_match:function(e,t){return e&&!e.match(t)},not_regex64_match:function(e,t){return!B(e,t)},not_starts_with:function(e,t){return!M(e,t)},kv_contains:function(e,t){return t[0]in e&&e[t[0]].indexOf(t[1])>=0},kv_equal:function(e,t){return e[t[0]]===t[1]},kv_not_contains:function(e,t){return!(t[0]in e&&e[t[0]].indexOf(t[1])>=0)},kv_not_equal:function(e,t){return e[t[0]]!==t[1]},regex_match:function(e,t){return e&&e.match(t)},regex64_match:B,starts_with:function(e,t){return M(e,t)}};function B(e,t){try{const n=N.decode(t);return e&&null!==e.match(function(e){if(!M(e,"/"))return new RegExp(e);const t=e.lastIndexOf("/");return new RegExp(e.substring(1,t),e.substring(t+1))}(n))}catch(e){return!1}}function K(e,t){const n=function e(t,n){if(void 0===t)return;const i=n.indexOf(".");if(0===i)throw new Error("Invalid variant key: "+n);return-1===i?n in t?t[n]:void 0:e(t[n.substring(0,i)],n.substring(i+1))}(e,t.field);return!(M(t.operator,"kv_")&&!n)&&!!D[t.operator](n,t.value)}function J(e,t,n,i,o){let r;return"combinator"in n?H(e,n,i,o):(r=K(e,n),(r?i:o).add({id:t.id,index:n.index,field:n.field}),r)}function H(e,t,n,i){const o=t.rules;if(!o)return!0;for(let r=0;r<o.length;r++){const s=J(e,t,o[r],n,i);if(s&&"or"===t.combinator)return!0;if(!s&&"and"===t.combinator)return!1}return"and"===t.combinator}function W(e,t){const n={passed:new Set,failed:new Set,touched:new Set};return n.rejected=!H(e,t,n.passed,n.failed),n.passed.forEach((function(e){n.touched.add(e.field)})),n.failed.forEach((function(e){n.touched.add(e.field)})),n}const V=/^([a-z]+):\/\/([^/]+)(.*)/i;function G(){return"undefined"!=typeof crypto?crypto:msCrypto}function $(e){if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e).buffer;const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0,i=e.length;t<i;t++)n[t]=e.charCodeAt(t);return t}function X(e){return e.then?e:I.createPromise((function(t,n){function i(e){n(e.toString())}e.oncomplete=function(e){t(e.target.result)},e.onerror=i,e.onabort=i}))}function Z(e,t){return'keyId="'+e+'",algorithm="hmac-sha384",signature="'+t+'"'}function Q(e){return I.createPromise((function(t,n){const i=new XMLHttpRequest;i.addEventListener("load",(function(){if(this.status>=400)n(this.statusText||"Evolv: Request failed "+this.status);else if(200===this.status)t(JSON.parse(this.responseText));else if(202===this.status)t();else{const e="Evolv: Invalid status "+this.status+" for response "+this.responseText;console.error(e),n(e)}})),i.addEventListener("error",n),i.open(e.method,e.url,e.sync),"POST"!==e.method.toUpperCase()&&"PUT"!==e.method.toUpperCase()||i.setRequestHeader("Content-Type",e.encoding),i.setRequestHeader("Accept","application/json"),e.signature&&i.setRequestHeader("Signature",Z(e.keyId,e.signature)),i.send(e.payload)}))}function Y(e){const t=this;return I.createPromise((function(n,i){const o=V.exec(e.url);if(!o)throw new Error("Evolv: Invalid endpoint URL");("http"===o[1]?t.import("http"):t.import("https")).then((function(t){const r=o[2],s=o[3],c={"Content-Type":e.encoding,Accept:"application/json","Content-Length":Buffer.byteLength(e.payload)};e.signature&&(c.Signature=Z(e.keyId,e.signature));const a=t.request({hostname:r,path:s,method:e.method,headers:c},(function(e){e.on("data",n)}));a.on("error",i),a.write(e.payload),a.end()}))}))}function ee(e){return I.createPromise((function(t,n){const i=g({},e);let o,r;i.encoding=i.encoding||"application/json; charset=UTF-8",o=i.data?"object"==typeof i.data?"application/x-www-form-urlencoded"===i.encoding?Object.keys(i.data).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(i.data[e])})).join("&"):JSON.stringify(i.data):i.data:"",i.payload=o,r="undefined"!=typeof XMLHttpRequest?Q:Y,i.key?function(e,t){const n={name:"HMAC",hash:"SHA-384"},i=["sign"],o=G();return I.createPromise((function(r,s){X(o.subtle.importKey("raw",$(e),n,!0,i)).then((function(e){X(o.subtle.sign(n,e,t)).then((function(e){r(N.encodeFromArrayBuffer(e))})).catch(s)})).catch(s)}))}(i.key,$(i.payload)).then((function(e){r(g({signature:e},i)).then(t).catch(n)})).catch(n):r(i).then(t).catch(n)}))}let te=!1;const ne="config",ie="genome",oe="request.failed",re="effective.genome.updated";function se(e,t,n,i){i=i||!1;let o=!1;return e.experiments.forEach((function(e){const r=e.get(t);r&&(i?r.forEach((function(e){n&&!M(e,n)||(o=!0)})):r.has(n)&&(o=!0))})),o}function ce(e,t,n){e.forEach((function(e){t.delete(e),n.add(e)}))}function ae(e){return function(){try{e.apply(void 0,arguments)}catch(e){console.log(e)}}}function ue(e,t){return h(e,t)}function de(e,t,n){return h(e,n)}function fe(e,t){return e.has(t)}function le(e,t,n){const i=[],o=[];function r(e){return!n||M(e,n)}return e.forEach((function(e){r(e)&&i.push(e)})),t.forEach((function(e){r(e)&&o.push(e)})),{current:i,previous:o}}function he(e,t){t||e.clear(),e.forEach((function(n){M(n,t)&&e.delete(n)}))}function ve(e){const t=[];return e.experiments.forEach((function(e,n){const i=e.get("entry");i&&i.size>0&&t.push(n)})),t}function pe(e,t,n){const i=new Map;if(!n._experiments||!n._experiments.length)return i;const o=t.resolve();return n._experiments.forEach((function(e){const t=g({},e);delete t.id;const n={disabled:[],entry:[]};!function e(t,n,i,o,r){if(n&&"object"==typeof n){if(n._predicate&&W(t,n._predicate).rejected)return void o.push(i);n._is_entry_point&&r.push(i),Object.keys(n).forEach((function(s){M(s,"_")||e(t,n[s],i?i+"."+s:s,o,r)}))}}(o,t,"",n.disabled,n.entry),i.set(e.id,n)})),i}function me(e,t,n,i,o){pe(0,t,n).forEach((function(e,n){const r=o.experiments.get(n);if(!r)return;const s=r.get("loaded"),c=new Set;s&&s.forEach((function(e){c.add(e)}));const a=function(e,t){const n={active:[],entry:[]};return t.forEach((function(t){e.disabled.some((function(e){return M(t,e)}))||(n.active.push(t),e.entry.some((function(e){return M(t,e)}))&&n.entry.push(t))})),n}(e,c),u=new Set;a.active.forEach((function(e){u.add(e)}));const d=(i||[]).filter((function(e){return e.eid===n}))[0];d&&function(e,t,n){const i=t.genome;if(!i)return;const o=e.resolve();n.forEach((function(e){const t=e.split(".");let r=i;for(let e=0;e<t.length;e++)r=r[t[e]]||{};const s=r._predicated_values,c=new Set;if(s){let t;for(let e=0;e<s.length;e++){const n=s[e],i=n._predicate?n._predicate:{combinator:"and",rules:L(c).map((function(e){return{field:e,operator:"defined"}}))},r=W(o,i);if(z(r.touched,c),!r.rejected){t=n._predicate_assignment_id;break}}if(!t)return;const i=e+"."+t;n.add(i)}}))}(t,d,u);const f=new Set;a.entry.forEach((function(e){f.add(e)})),r.set("active",u),r.set("entry",f)}))}function ge(e){const t=e.version||1,n=e.endpoint+"/"+e.environment,i=e.auth&&e.auth.id,o=e.auth&&e.auth.secret;let r,s=null,c=!1,d=!1,l=!0,h={},v={},y=null,w=null,b=new Set,E=new Set,_=new Set,A=new Set,j=new Set,C=!1,S=!1;const T={needed:new Set,requested:new Set,experiments:new Map},P={needed:new Set,requested:new Set,experiments:new Map};let L=[],R=[],U=new Set;function F(){if(!w)return;if(te)return;te=!0,me(0,r,w,y,P);const e=function(e,t){let n={};const i=new Set;return e.forEach((function(e,o){const r=e.get("active");if(o in t&&r){const e=m(u(t[o]),r);Object.keys(e).length&&(i.add(o),n=a(n,e))}})),{effectiveGenome:n,activeEids:i}}(P.experiments,h);v=e.effectiveGenome,b=e.activeEids,_.clear(),z(E,_),E.clear(),j.clear(),z(A,j),A.clear(),P.experiments.forEach((function(e){const t=e.get("active");if(t){t.forEach((function(e){E.add(e)}));const e=p(v,t);Object.keys(e).forEach((function(t){A.add(t.concat(":",function(e){for(var t=0,n=0,i=e.length;n<i;n++)t=31*t+e.charCodeAt(n)<<0;return t}(JSON.stringify(e[t]))))}))}}));const t=[];E.forEach((function(e){t.push(e)})),r.set("keys.active",t);const n=[];A.forEach((function(e){n.push(e)})),r.set("variants.active",n),k(r,re,v),U.forEach((function(e){try{e(v,w)}catch(e){console.error(e)}})),te=!1}function N(e){w=e,S=!1,"_client"in w&&(s=w._client),e._experiments.forEach((function(e){!function(e,t){const n=g({},t);delete n.id;const i=new Set,o=new Map;o.set("loaded",i),e.experiments.set(t.id,o),f(n,(function(e){return!M(e,"_")||"_values"===e||"_initializers"===e})).filter((function(e){return q(e,"_values")||q(e,"_initializers")})).forEach((function(e){i.add(e.replace(/._values|._initializers/gi,""))}))}(P,e)}))}function D(e,n,i){let o=e?P:T;n.forEach(o.requested.delete.bind(o.requested)),e?(k(r,"config.request.received",n),N(i)):(k(r,"genome.request.received",n),function(e){const t=[],n=[];y=e,C=!1,e.forEach((function(e){const i=g({},e);if(delete i.genome,delete i.audience_query,t.push(i),i.excluded)return void n.push(i.eid);h[i.eid]=e.genome;const o=new Set,r=new Map;r.set("loaded",o),T.experiments.set(i.eid,r),f(e.genome,(function(e){return!M(e,"_")})).forEach(o.add.bind(o))})),r.set("experiments.allocations",t),r.set("experiments.exclusions",n)}(i)),F();let s=[],c=[];L.concat(R).forEach((function(i){if(!(i.source!==ie||i.key&&se(T,"loaded",i.key)))return;let o=!0;i.key&&(o=se(P,"loaded",i.key,!0)),(o||e&&(1===t||n.indexOf(i.key)>=0))&&(i.resolve(i.transform(i.key,v,w)),(i.source===ne?s:c).push(i))})),L=L.filter((function(e){return c.indexOf(e)<0})),R=R.filter((function(e){return s.indexOf(e)<0})),k(r,e?"config.updated":"genome.updated",i)}function B(e,n,i){let o,s;console.log(i),k(r,oe,e?ne:ie,n,i),o=e?P:T,ce(n,o.requested,o.needed),e?(s=R,S=!0):(s=L,C=!0);let c=[],a=[];L.concat(R).forEach((function(e){if(1===t||n.indexOf(e.key)>=0){(e.source===ne?c:a).push(e);try{e.reject(i)}catch(e){console.error(e)}}})),L=L.filter((function(e){return a.indexOf(e)>=0})),R=R.filter((function(e){return c.indexOf(e)>=0})),e?R=s:L=s}function K(e){if(c)if(e||l){if(l=!1,P.needed.size||1===t){const e=[];P.needed.forEach(e.push.bind(e)),P.needed.clear(),ee({method:"get",url:n+"/"+r.uid+"/configuration.json",keyId:i,key:o}).then(D.bind(this,!0,e)).catch(B.bind(this,!0,e)),ce(e,P.needed,P.requested),k(r,"config.request.sent",e)}if(T.needed.size||1===t){const e=[];T.needed.forEach(e.push.bind(e)),T.needed.clear(),ee({method:"get",url:n+"/"+r.uid+"/allocations",keyId:i,key:o}).then(D.bind(this,!1,e)).catch(B.bind(this,!1,e)),ce(e,T.needed,T.requested),k(r,"genome.request.sent",e)}d=!1}else d||(d=!0,setTimeout(K.bind(void 0,!0)));else l=l||e}function J(e,n,i){let o=null,r=null;const s=I.createPromise((function(e,t){o=ae(e),r=ae(t)}));let c,a,u;s.listen=function(e){U.add((function(t,o){e(n(i,t,o))}))};let d=!1;if(e===ie?(c=T,a=C,u=L,d=se(c,"loaded",i)):(c=P,a=S,u=R,d=se(c,"loaded",i,!0)),d)return o(n(i,v,w)),s;if(se(c,"loaded",i))return o(n(i,v,w)),s;if(a)return r("The values could not be retrieved"),s;const f={key:i,resolve:o,reject:r,transform:n,source:e};return u.push(f),1===t||c.needed.has(i)||c.requested.has(i)||(c.needed.add(i),e===ie&&P.needed.add(i),K()),s}if(Object.defineProperty(this,"configuration",{get:function(){return w},configurable:!0}),Object.defineProperty(this,"activeEids",{get:function(){return b},configurable:!0}),this.destroy=function(){h=void 0,v=void 0,y=void 0,w=void 0,b=void 0,E=void 0,_=void 0,delete T.needed,delete T.requested,delete T.experiments,delete P.needed,delete P.requested,delete P.experiments,L.forEach((function(e){e.reject()})),L=void 0,R.forEach((function(e){e.reject()})),R=void 0,U=void 0,k(r,"store.destroyed",this),r=void 0},1===t)K(!0);else if(2!==e.version)throw new Error("Unsupported API version");Object.defineProperty(this,"state",{get:function(){return{allocations:u(y),config:u(w)}}}),this.fetch=K.bind(this,!0),this.preload=function(e,t,n){e.forEach(P.needed.add.bind(P.needed)),t||e.forEach(T.needed.add.bind(T.needed)),K(n)},this.initialize=function(e){if(c)throw new Error("Evolv: The store has already been initialized.");r=e,c=!0,K(),x(r,O,F)},this.getClientContext=function(){return J.call(this,ne,(function(){return s}))},this.subscribe=U.add.bind(U),this.unsubscribe=U.delete.bind(U),this.get=J.bind(this,ie,ue.bind(this)),this.getConfig=J.bind(this,ne,de.bind(this)),this.activeEntryPoints=J.bind(this,ne,ve.bind(this,P)),this.isActive=J.bind(this,ne,fe.bind(this,E)),this.getActiveKeys=J.bind(this,ne,le.bind(this,E,_)),this.clearActiveKeys=he.bind(this,E),this.reevaluateContext=F.bind(this)}const ye=/\/(v\d+)\/\w+\/([a-z]+)$/i;function we(e,t,n){const i=e.match(ye),o=i&&"v1"===i[1]&&"events"===i[2];let r,s=n||!1,c=[];function a(e,t,n){return"undefined"!=typeof window&&window.navigator.sendBeacon?window.navigator.sendBeacon(e,t):function(e,t,n){return ee({method:"post",url:e,data:t,sync:n}).catch((function(e){console.log(e)})),!0}(e,t,n)}function u(){let n=!1;if(void 0!==this){const e=this.event&&this.event.type;n="unload"===e||"beforeunload"===e}if(!c.length||s)return;let i=c;if(c=[],r&&clearTimeout(r),r=void 0,o)i.forEach((function(t){let i=t;i=t.payload||{},i.type=t.type,a(e,JSON.stringify(i),n)||(c.push(t),console.error("Evolv: Unable to send event beacon"))}));else for(;;){const o=i.slice(0,25);if(0===o.length)break;if(!a(e,JSON.stringify((d=o,{uid:t.uid,messages:d})),n)){c=i,console.error("Evolv: Unable to send analytics beacon");break}i=i.slice(25)}var d;c.length&&(r=setTimeout(u,1))}"undefined"!=typeof window&&(window.addEventListener("unload",u),window.addEventListener("beforeunload",u)),this.unblockAndFlush=function(){s=!1,u()},this.emit=function(e,n,i){c.push({type:e,payload:n,sid:t.sid,timestamp:(new Date).getTime()}),i?u():r||(r=setTimeout(u,1))},this.flush=u}function be(e){let t=!1;if(!e.environment)throw new Error('"environment" must be specified');"autoConfirm"in e||(e.autoConfirm=!0),e.version=e.version||1,e.endpoint=(e.endpoint||"https://participants.evolv.ai/")+"v"+e.version,e.analytics="analytics"in e?e.analytics:e.version>1;const n=e.store||new ge(e),i=e.context||new T(n),o=e.analytics?new we(e.endpoint+"/"+e.environment+"/data",i,e.bufferEvents):null,r=e.beacon||new we(e.endpoint+"/"+e.environment+"/events",i,e.bufferEvents);Object.defineProperty(this,"context",{get:function(){return i}}),Object.defineProperty(this,"environment",{get:function(){return e.environment}}),this.on=x.bind(void 0,i),this.once=_.bind(void 0,i),this.preload=n.preload.bind(n),this.get=n.get.bind(n),this.isActive=n.isActive.bind(n),this.getActiveKeys=n.getActiveKeys.bind(n),this.clearActiveKeys=n.clearActiveKeys.bind(n),this.reevaluateContext=n.reevaluateContext.bind(n),this.getConfig=n.getConfig.bind(n),this.emit=function(e,t,n){i.pushToArray("events",{type:e,timestamp:(new Date).getTime()}),r.emit(e,g({uid:i.uid,sid:i.sid,metadata:t}),n),k(i,be.EVENT_EMITTED,e,t)},this.confirm=function(){x(i,re,(function(){const e=(i.remoteContext.experiments||{}).allocations;n.configuration&&e&&e.length&&n.activeEntryPoints().then((function(t){if(!t.length)return;const o=i.get("experiments.confirmations")||[],s=o.map((function(e){return e.cid})),c=(i.get("experiments.contaminations")||[]).map((function(e){return e.cid})),a=e.filter((function(e){return s.indexOf(e.cid)<0&&c.indexOf(e.cid)<0&&n.activeEids.has(e.eid)}));if(!a.length)return;const u=(new Date).getTime(),d=a.map((function(e){return{cid:e.cid,timestamp:u}})).concat(o);i.update({confirmations:d,experiments:{confirmations:d}}),a.forEach((function(e){r.emit("confirmation",g({uid:e.uid,sid:e.sid,eid:e.eid,cid:e.cid},i.remoteContext))})),r.flush(),k(i,be.CONFIRMED)}))}))},this.contaminate=function(e,t){const o=(i.remoteContext.experiments||{}).allocations;if(!o||!o.length)return;if(e&&!e.reason)throw new Error("Evolv: contamination details must include a reason");const s=i.get("experiments.contaminations")||[],c=s.map((function(e){return e.cid})),a=o.filter((function(e){return c.indexOf(e.cid)<0&&(t||n.activeEids.has(e.eid))}));if(!a.length)return;const u=(new Date).getTime(),d=a.map((function(e){return{cid:e.cid,timestamp:u}})).concat(s);i.update({contaminations:d,experiments:{contaminations:d}}),a.forEach((function(t){r.emit("contamination",g({uid:t.uid,sid:t.sid,eid:t.eid,cid:t.cid,contaminationReason:e},i.remoteContext))})),r.flush(),k(i,be.CONTAMINATED)},this.initialize=function(r,s,c,a){if(t)throw new Error("Evolv: Client is already initialized");if(!r)throw new Error('Evolv: "uid" must be specified');if(!s)throw new Error('Evolv: "sid" must be specified');i.initialize(r,s,c,a),n.initialize(i),n.getClientContext().then((function(e){if(!e)return;const t=g({},e);t.browser&&(t.web={client:{browser:t.browser}},delete t.browser),i.update(t,!1)})).catch((function(){console.log("Evolv: Failed to retrieve client context")})),e.analytics&&(x(i,A,(function(e,t){o.emit(e,i.remoteContext)})),x(i,C,(function(e,t,n,i){i||o.emit(e,{key:t,value:n})})),x(i,S,(function(e,t,n,i,r){r||o.emit(e,{key:t,value:n})})),x(i,j,(function(e,t,n){n||o.emit(e,{key:t})}))),e.autoConfirm&&(this.confirm(),x(i,oe,this.contaminate.bind(this))),t=!0,k(i,be.INITIALIZED,e)},this.flush=function(){r.flush(),e.analytics&&o.flush()},this.allowEvents=function(){r.unblockAndFlush(),e.analytics&&o.unblockAndFlush()},this.destroy=function(){var e;this.flush(),n.destroy(),i.destroy(),e=i,y.delete(e),w.delete(e),b.delete(e)}}function Ee(){return Math.round(1e8*Math.random())+"_"+(new Date).getTime()}be.INITIALIZED="initialized",be.CONFIRMED="confirmed",be.CONTAMINATED="contaminated",be.EVENT_EMITTED="event.emitted";const xe=function(){function e(){this.disposers=[]}return e.prototype.waitFor=function(e,t){this.dispose();let n;return function i(){cancelAnimationFrame(n);try{e.every((function(e){return null!==document.querySelector(e)}))?t(null):n=requestAnimationFrame(i)}catch(e){t(e)}}(),this.addDisposer((function(){cancelAnimationFrame(n)}))},e.prototype.addDisposer=function(e){return this.disposers.push(e),e},e.prototype.dispose=function(){this.disposers.forEach((function(e){"function"==typeof e&&e()})),this.disposers=[]},e}();function _e(e){return"evolv_".concat(e.replace(/\./g,"_"))}const ke=function(e){return-1!==["immediate","legacy"].indexOf(e.timing)},Oe=function(e){return"runnable"===e.status},Ae=function(e){return-1!==["runnable","running"].indexOf(e.status)},je=1,Ce=3,Se=4,Te={loading:je,interactive:Ce,complete:Se,immediate:je,legacy:2,"dom-content-loaded":Ce,"wait-for-elements":Ce,loaded:Se},Pe=function(){function e(e){this.container=e,this.initialized=!1,this.timedOut=!1,this.runLevel=Te[document.readyState],this.runs=[],this.functions=[],this.deferred=null,this.onReadyStateChange=function(){switch(document.readyState){case"interactive":this.setRunLevel(Ce);break;case"complete":this.setRunLevel(Se)}}.bind(this),document.addEventListener("readystatechange",this.onReadyStateChange),this.doLegacyTiming(),e.options.variantsLoaded&&e.options.variantsLoaded.then(function(){this.loadFunctions()}.bind(this)),this.loadFunctions()}return e.prototype.setRunLevel=function(e){const t=this.runLevel;this.runLevel=Math.max(t,e),this.runLevel!==t&&this.execute()},e.prototype.areVariantsDefined=function(){if("undefined"==typeof window)return!1;const e=(window||{}).evolv;return void 0!==e&&e.javascript&&e.javascript.variants},e.prototype.loadFunctions=function(){if(!this.areVariantsDefined()||this.initialized)return;if(this.initialized=!0,this.hasTimeoutElapsed())return;const e=window.evolv.javascript.variants;Object.keys(e).sort((function(e,t){return e.length-t.length})).forEach(function(t){const n=e[t];this.functions.push({key:t,timing:n.timing||"legacy",status:"not-runnable",runNumber:null,calls:0,handler:n,disposer:null})}.bind(this)),this.deferred&&this.updateFunctionsToRun(this.deferred)},e.prototype.updateFunctionsToRun=function(e){this.initialized?(this.functions.forEach(function(t){-1===e.indexOf(t.key)&&this.unschedule(t.key)}.bind(this)),e.forEach(function(e){this.schedule(e)}.bind(this)),this.execute()):this.deferred=e},e.prototype.schedule=function(e){const t=this.functions.filter((function(t){return t.key===e}))[0];t&&"not-runnable"===t.status&&(t.status="runnable")},e.prototype.unschedule=function(e){const t=this.functions.filter((function(t){return t.key===e}))[0];t.status="not-runnable",t.disposer&&t.disposer()},e.prototype.unscheduleByPrefix=function(e){this.functions.filter((function(t){return t.key.startsWith(_e(e))})).forEach(function(e){this.unschedule(e.key)}.bind(this))},e.prototype.execute=function(){const e=this.container.client,t=function(e){return Te[e.timing]<=this.runLevel}.bind(this),n=this.functions.filter(t).filter(Oe),i=this.functions.filter(t).filter(Ae).filter(ke).map((function(e){return e.key}));this.runs.push(Object.freeze({neededToConfirm:i}));const o=this.runs.length;n.forEach(function(t){t.status="running",t.runNumber=o,t.calls+=1;const n=this.getExecutor(t);t.disposer=n.disposer,n.promise.then((function(){"running"===t.status&&(t.status="resolved")})).catch((function(n){const i=n&&n.message?n.message:"";t.status="rejected",e.contaminate({reason:"error-thrown",details:i}),console.warn("[Evolv]: An error occurred while applying a javascript mutation. "+n)})).finally(function(){this.checkForConfirmation(o)}.bind(this))}.bind(this))},e.prototype.getExecutor=function(e){const t=e.handler,n=new xe;return{promise:I.createPromise((function(i,o){const r=function(t){t&&o(t);try{const t={key:(n=e.key,n.replace(/^evolv_/,"").replace(/_/g,"."))};!0!==e.handler.call(t,i,o)&&i()}catch(t){o(t)}var n};if("wait-for-elements"===t.timing){const e=t.timingSelectors||[];n.waitFor(e,r)}else r()})),disposer:n.dispose.bind(n)}},e.prototype.checkForConfirmation=function(e){const t=this.runs[e-1];this.functions.filter((function(e){return-1!==t.neededToConfirm.indexOf(e.key)})).every((function(e){return-1!==["resolved","not-runnable"].indexOf(e.status)}))&&this.confirm()},e.prototype.confirm=function(){this.container.client.confirm()},e.prototype.hasTimeoutElapsed=function(){if(this.timedOut)return!0;const e=this.container,t=e.client,n=e.options,i=e._performance,o=(new Date).getTime(),r=i?i.timing.domContentLoadedEventStart:0,s=n.timeoutThreshold||6e4;return r>0&&o>r+s&&(this.timedOut=!0,t.contaminate({reason:"timeout-exceeded",details:"current time: "+o+", domContentLoadedEventStart: "+r+", threshold: "+s}),console.warn("[Evolv]: Loading of variants timed out."),!0)},e.prototype.doLegacyTiming=function(){const e=this.container.options.legacyPollingInterval,t=function(){const n=this.hasTimeoutElapsed();if(this.loadFunctions(),this.initialized&&!n)this.setRunLevel(Te.legacy);else if(!n){if("undefined"==typeof window)return;setTimeout(t,e||100)}}.bind(this);t()},e}();function Ie(e,t){let n=[],i=!1;const o=e.client;const r=o.environment,s=(c=r,document.querySelector('link[href *= "'+c+'"][href *= "assets.css"]'));var c;const a=function(e){return document.querySelector('script[src *= "'+e+'"][src *= "assets.js"]')}(r),u=t||new Pe(e);this.rerun=function(e){e=e||"web",u.unscheduleByPrefix(e),o.clearActiveKeys(e),o.reevaluateContext()},o.getActiveKeys("web").listen((function(e){const t=e.current.map(_e).sort((function(e,t){return e.length-t.length}));n.forEach((function(e){document.documentElement.classList.remove(e)})),s&&(t.forEach((function(e){document.documentElement.classList.add(e)})),n=t.slice()),a?u.updateFunctionsToRun(t):s&&(i||(o.confirm(),i=!0))}))}function Le(e,t,n,i){e.context.set("web.url",window.location.href),Object.defineProperty(this,"client",{get:function(){return e}}),Object.defineProperty(this,"context",{get:function(){return e.context}});const o={client:e,options:t||{},_performance:n||window.performance};Ie.call(this,o,i)}function Re(e,t){let n=t,i={},o={},r=function(e){return e?o:i};function s(t,n){return e&&!n?function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var i=t[n].split("=");if(e==i[0].trim())return decodeURIComponent(i[1])}return null}("evolv:"+t):(n?window.sessionStorage:window.localStorage).getItem("evolv:"+t)}this.store=function(t,i,o){if(n){if(e&&!o){return function(e,t,n,i){var o=e+"="+encodeURIComponent(t);"number"==typeof n&&(o+="; max-age="+24*n*60*60+"; path=/"+(i?"; domain="+i:""),document.cookie=o)}("evolv:"+t,i,365,"true"===e?"":e)}(o?window.sessionStorage:window.localStorage).setItem("evolv:"+t,i)}else r(o)[t]={value:i,session:o}},this.retrieve=function(e,t){let i=s(e,t);if(void 0!==i)return i;if(!n){let n=r(t);return n[e]&&n[e].value}return i},this.allowPersistentStorage=function(){if(n)return;n=!0;let e=this.store;Object.keys(i).forEach((function(t){e(t,i[t].value,!1)})),Object.keys(o).forEach((function(t){e(t,o[t].value,!0)})),i={},o={}}}const Me="evolvCandidateToken=(([0-9]+)_([0-9]+)_([0-9a-z]+))";const qe="evolvBlockExecution=(true|false)";const ze=[{shouldActivate:function(e){const t=window.location.hash.match(new RegExp(Me));return t&&e===t[4]},activate:function(){const e=window.location.hash.match(new RegExp(Me));if(e){const t=e[1];window.sessionStorage.setItem("evolv:candidateToken",t),window.location.href=window.location.href.replace(new RegExp("#?&?evolvCandidateToken=(([0-9]+)_([0-9]+)_([0-9a-z]+))"),"")}}},{shouldActivate:function(){const e=new RegExp(qe);return!!(window.location.hash.match(e)||window.location.search.match(e))},activate:function(){const e=new RegExp(qe),t=window.location.hash.match(e)||window.location.search.match(e);t&&(window.sessionStorage.setItem("evolv:blockExecution",t[1]),window.location.href=window.location.href.replace(new RegExp("#?\\??&?evolvBlockExecution=(true|false)"),""))}}];let Ue=0;function Fe(){const e=window.localStorage.getItem("evolv:uid");if(e)window.evolv.setUid(e);else{if(Ue>60){console.warn("Evolv: GA clientId not found, using generated UID");const e=Ee();return window.localStorage.setItem("evolv:uid",e),window.evolv.setUid(e),void window.evolv.client.emit("evolv-uid.generated")}"function"==typeof window.ga?window.ga((function(){var e=window.ga.getAll();0===e.length?Ne():window.evolv.setUid(e[0].get("clientId"))})):Ne()}}function Ne(){Ue++,setTimeout(Fe,0)}function De(e,t,n){let i;return e.context&&t in e.context?i=e[t]:(i=e.retrieve(t,n),i||(i=Ee(),e.store(t,i,n))),i}function Be(e){return e&&e.dataset&&"evolvEnvironment"in e.dataset}function Ke(e){return"true"===e.dataset.evolvRequireConsent}navigator.doNotTrack&&"unspecified"!==navigator.doNotTrack&&"0"!==navigator.doNotTrack||"undefined"==typeof Map||function e(){window.evolv=window.evolv||{};const t=window.evolv,n=function(){if(document.currentScript&&Be(document.currentScript))return document.currentScript;for(let e=0;e<document.scripts.length;e++){const t=document.scripts[e];if(Be(t))return t}throw new Error("[Evolv] Environment not specified")}();if(t.setUid=function(t){t&&(n.dataset.evolvUid=t,e())},function(e){return!(!e.dataset.evolvLazyUid||e.dataset.evolvUid&&(t=e.dataset.evolvUid,/^\d+[.|_]\d+$/.test(t)));var t}(n))return void Fe();if(function(e){if(e.instancesCount?e.instancesCount++:e.instancesCount=1,window.CustomEvent)try{const t=new CustomEvent("webloader-loaded",{detail:e.instancesCount});document.dispatchEvent(t)}catch(e){console.warn("Evolv: Could not fire custom event")}if(e.instancesCount>1)return console.warn("Multiple Evolv instances - please verify you have only loaded Evolv once"),!0}(t))return;t.markConsented=function(){i.allowPersistentStorage(),t.client.allowEvents()};let i=new Re(n.dataset.evolvUseCookies,!Ke(n));if(t.store||(t.store=i.store.bind(i)),t.retrieve||(t.retrieve=i.retrieve.bind(i)),ze.forEach((function(e){return e.shouldActivate(n.dataset.evolvEnvironment)&&e.activate()})),"true"===window.sessionStorage.getItem("evolv:blockExecution"))return;const o=window.sessionStorage.getItem("evolv:candidateToken"),r=o||n.dataset.evolvEnvironment;let s=n.dataset.evolvJs,c=n.dataset.evolvCss,a=n.dataset.evolvPushstate,u=n.dataset.evolvEndpoint||"https://participants.evolv.ai/";const d=n.dataset.evolvUid||De(t,"uid",!1),f=n.dataset.evolvSid||De(t,"sid",!0);s=!!o||!s||"true"===s,c=!!o||!c||"true"===c,a=a&&"true"===a;const l=s?function(e,t,n,i){return I.createPromise((function(o,r){const s=document.createElement("script");s.type="text/javascript",s.src=e+"v"+n+"/"+t+"/"+i+"/assets.js",s.defer=!0,s.onload=o,s.onerror=r,document.head.appendChild(s)}))}(u,r,1,d):I.createPromise((function(e){e()}));c&&function(e,t,n,i){const o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.setAttribute("href",e+"v"+n+"/"+t+"/"+i+"/assets.css"),document.head.appendChild(o)}(u,r,1,d);let h=t.client;if(!h){let e={environment:r,endpoint:u,version:1,autoConfirm:!1,analytics:!0,bufferEvents:Ke(n)};h=new be(e),h.initialize(d,f),Object.defineProperty(window.evolv,"client",{get:function(){return h}}),Object.defineProperty(window.evolv,"context",{get:function(){return h.context}})}a&&function(e){const t=history.pushState,n=history.replaceState;function i(){e.context.set("web.url",window.location.href)}function o(e){const t=Array.prototype.slice.call(arguments,1);let n;e.apply(history,t);const i="stateupdate_evolv";"function"==typeof CustomEvent?n=new CustomEvent(i,{}):(n=document.createEvent("CustomEvent"),n.initEvent(i,!1,!1,{})),window.dispatchEvent(n)}history.pushState=o.bind(this,t),history.replaceState=o.bind(this,n),window.addEventListener("popstate",i),window.addEventListener("stateupdate_evolv",i)}(h),h.context.set("webloader.js",s),h.context.set("webloader.css",c);const v=new Le(h,{timeoutThreshold:n.dataset.evolvTimeout?n.dataset.evolvTimeout-0:void 0,variantsLoaded:l});Object.defineProperty(window.evolv,"assetManager",{get:function(){return v}}),window.evolv.rerun=v.rerun.bind(v)}()}();
